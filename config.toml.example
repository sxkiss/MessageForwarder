# ========================================
# 消息转发插件配置文件模板
# ========================================
# 作者: sxkiss
# 版本: 1.1.0
# 更新时间: 2025-06-18
#
# 本插件支持转发多种类型的微信消息，包括：
# - 文本消息
# - 图片消息  
# - 视频消息
# - 名片消息 (新增)
# - 其他消息类型

[basic]
# 是否启用插件
enable = true

# 插件优先级 (0-99)，数值越高优先级越高
priority = 80

# ========================================
# 转发目标配置
# ========================================
[forwarder]
# 转发目标类型
# "user" - 转发到个人用户
# "group" - 转发到群聊
target_type = "user"

# 目标用户的微信ID (当target_type为"user"时使用)
# 示例: "filehelper" (文件传输助手，用于测试)
# 示例: "wxid_xxxxxxxxx" (具体用户的微信ID)
target_user_wxid = "filehelper"

# 目标群聊的微信ID (当target_type为"group"时使用)  
# 示例: "12345678@chatroom"
target_group_wxid = ""

# ========================================
# 监听源配置
# ========================================
[listen_source]
# 监听类型
# "all" - 监听所有消息
# "user" - 只监听指定用户的消息
# "group" - 只监听指定群聊的消息
listen_type = "all"

# 监听的用户微信ID列表 (当listen_type为"user"时使用)
# 示例: ["wxid_user1", "wxid_user2"]
listen_user_wxids = []

# 监听的群聊微信ID列表 (当listen_type为"group"时使用)
# 示例: ["group1@chatroom", "group2@chatroom"]
listen_group_wxids = []

# ========================================
# 配置示例
# ========================================

# 示例1: 转发所有消息到文件传输助手
# [forwarder]
# target_type = "user"
# target_user_wxid = "filehelper"
# [listen_source]
# listen_type = "all"

# 示例2: 只转发特定用户的消息到指定群聊
# [forwarder]
# target_type = "group"
# target_group_wxid = "backup_group@chatroom"
# [listen_source]
# listen_type = "user"
# listen_user_wxids = ["wxid_friend1", "wxid_friend2"]

# 示例3: 只转发特定群聊的消息到个人用户
# [forwarder]
# target_type = "user"
# target_user_wxid = "wxid_admin"
# [listen_source]
# listen_type = "group"
# listen_group_wxids = ["work_group@chatroom", "family_group@chatroom"]

# ========================================
# 支持的消息类型
# ========================================
# 1. 文本消息
#    - 直接转发文本内容
#    - 支持@功能（群聊中）
#
# 2. 图片消息
#    - 转发Base64格式的图片内容
#    - 自动处理图片数据格式
#
# 3. 视频消息
#    - 支持CDN视频消息直接转发（优先）
#    - 支持Base64视频内容转发（备用）
#    - 自动生成视频缩略图
#
# 4. 名片消息 (MsgType=42) [新增功能]
#    - 解析XML格式的名片信息
#    - 提取wxid、昵称、备注等信息
#    - 使用ShareCard API直接转发
#    - 支持群聊和私聊中的名片消息
#
# 5. 其他消息类型
#    - XML消息处理
#    - 文件消息信息提取

# ========================================
# 获取微信ID的方法
# ========================================
# 1. 个人微信ID:
#    - 通常格式: wxid_xxxxxxxxx
#    - 可通过机器人日志查看
#    - 可通过API获取联系人列表
#
# 2. 群聊微信ID:
#    - 通常格式: 数字@chatroom
#    - 例如: 12345678@chatroom
#    - 可通过机器人日志查看群聊消息
#    - 可通过API获取群聊列表
#
# 3. 特殊ID:
#    - filehelper: 文件传输助手
#    - 适合用于测试转发功能

# ========================================
# 使用说明
# ========================================
# 1. 复制此文件为 config.toml
# 2. 根据需要修改配置参数
# 3. 重启插件或重新加载配置
# 4. 查看日志确认配置是否生效
#
# 注意事项:
# - 建议先使用filehelper测试功能
# - 确保目标微信ID正确有效
# - 监听源配置支持精确控制转发范围
# - 名片转发使用直接API调用，确保兼容性

# ========================================
# 故障排除
# ========================================
# 1. 转发失败:
#    - 检查目标微信ID是否正确
#    - 确认机器人与目标用户/群聊的关系
#    - 查看插件日志获取详细错误信息
#
# 2. 名片转发404错误:
#    - 已在v1.1.0版本中修复
#    - 使用正确的ShareCard API端点
#
# 3. 配置不生效:
#    - 确认config.toml文件格式正确
#    - 重启插件或重新加载配置
#    - 检查插件是否启用 (enable = true)